@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    @apply scroll-smooth antialiased;
  }

  body {
    @apply min-h-screen text-slate-900 transition-colors duration-300;
    background:
      radial-gradient(circle at 14% 14%, rgba(171, 201, 255, 0.3), transparent 34%),
      radial-gradient(circle at 82% 16%, rgba(211, 197, 255, 0.26), transparent 30%),
      radial-gradient(circle at 72% 86%, rgba(177, 234, 219, 0.2), transparent 33%),
      linear-gradient(160deg, #f6f8fc 0%, #f7f8ff 46%, #eef5ff 100%);
  }

  .dark body {
    @apply text-slate-100;
    background:
      radial-gradient(circle at 18% 12%, rgba(69, 108, 197, 0.22), transparent 34%),
      radial-gradient(circle at 84% 18%, rgba(122, 87, 199, 0.18), transparent 34%),
      linear-gradient(170deg, #161922 0%, #171d2a 42%, #101523 100%);
  }
}

@layer components {
  .surface-panel {
    @apply rounded-2xl border backdrop-blur-md;
    background: rgba(255, 255, 255, 0.66);
    border-color: rgba(255, 255, 255, 0.78);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.86),
      0 18px 36px -24px rgba(112, 132, 172, 0.36),
      0 8px 22px -18px rgba(140, 159, 197, 0.34);
  }

  .dark .surface-panel {
    background: rgba(29, 35, 50, 0.82);
    border-color: rgba(118, 144, 214, 0.36);
    box-shadow:
      inset 0 1px 0 rgba(188, 211, 255, 0.12),
      0 24px 46px -30px rgba(0, 6, 20, 0.84),
      0 12px 24px -18px rgba(0, 7, 22, 0.74);
  }

  .glass-card {
    @apply relative overflow-hidden rounded-2xl border;
    background: rgba(255, 255, 255, 0.7);
    border-color: rgba(255, 255, 255, 0.82);
    -webkit-backdrop-filter: blur(18px) saturate(140%);
    backdrop-filter: blur(18px) saturate(140%);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.9),
      0 16px 30px -18px rgba(102, 124, 168, 0.28),
      0 28px 46px -30px rgba(112, 136, 182, 0.26);
  }

  .glass-card::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
      linear-gradient(135deg, rgba(255, 255, 255, 0.5) 0%, rgba(255, 255, 255, 0.14) 44%, rgba(79, 143, 255, 0.2) 100%);
    z-index: 0;
  }

  .glass-card > * {
    position: relative;
    z-index: 1;
  }

  .card-lux {
    isolation: isolate;
  }

  .card-lux::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    z-index: 0;
    background:
      linear-gradient(130deg, rgba(255, 255, 255, 0.44) 0%, rgba(255, 255, 255, 0) 34%, rgba(114, 160, 255, 0.2) 100%);
    opacity: 0.9;
  }

  .card-lux::after {
    content: '';
    position: absolute;
    inset: -35% -25%;
    pointer-events: none;
    border-radius: 999px;
    z-index: 0;
    background:
      radial-gradient(circle, rgba(125, 168, 255, 0.2) 0%, rgba(125, 168, 255, 0) 68%);
    transform: translateY(28%);
    opacity: 0.52;
    transition:
      transform 340ms ease,
      opacity 260ms ease;
  }

  .card-lux:hover::after {
    transform: translateY(18%);
    opacity: 0.72;
  }

  .dark .card-lux::before {
    background:
      linear-gradient(130deg, rgba(179, 207, 255, 0.2) 0%, rgba(179, 207, 255, 0) 40%, rgba(113, 102, 255, 0.2) 100%);
    opacity: 0.82;
  }

  .dark .card-lux::after {
    background:
      radial-gradient(circle, rgba(97, 133, 255, 0.32) 0%, rgba(97, 133, 255, 0) 68%);
    opacity: 0.62;
  }

  .card-lux > * {
    position: relative;
    z-index: 1;
  }

  .card-headline {
    letter-spacing: -0.008em;
    text-wrap: pretty;
  }

  .card-answer {
    max-width: 68ch;
    text-wrap: pretty;
  }

  .answer-reveal {
    animation: answerReveal 280ms cubic-bezier(0.22, 0.78, 0.2, 1) both;
  }

  .action-icon-btn {
    @apply rounded-lg border px-2 py-1 text-sm transition-all duration-200;
    border-color: rgba(149, 163, 188, 0.54);
    background: rgba(255, 255, 255, 0.64);
    color: rgba(51, 65, 85, 0.78);
    opacity: 0.74;
    box-shadow: 0 8px 18px -16px rgba(30, 41, 59, 0.46);
  }

  .action-icon-btn:hover {
    border-color: rgba(79, 143, 255, 0.62);
    color: rgb(47 123 255);
    opacity: 1;
    box-shadow: 0 12px 24px -16px rgba(47, 123, 255, 0.42);
  }

  .dark .action-icon-btn {
    border-color: rgba(100, 116, 139, 0.64);
    background: rgba(32, 39, 55, 0.82);
    color: rgba(226, 232, 240, 0.82);
    opacity: 0.76;
    box-shadow: 0 10px 20px -16px rgba(2, 8, 23, 0.72);
  }

  .dark .action-icon-btn:hover {
    border-color: rgba(116, 151, 226, 0.8);
    color: rgb(191 219 254);
    opacity: 1;
    box-shadow: 0 14px 24px -16px rgba(68, 110, 196, 0.54);
  }

  .primary-soft-btn {
    @apply rounded-lg border px-2 py-1 text-[11px] font-semibold transition;
    border-color: rgba(109, 159, 255, 0.52);
    background: rgba(255, 255, 255, 0.68);
    color: rgb(36 95 194);
    box-shadow: 0 8px 18px -16px rgba(47, 123, 255, 0.48);
  }

  .primary-soft-btn:hover {
    border-color: rgba(82, 146, 255, 0.72);
    background: rgba(255, 255, 255, 0.82);
    color: rgb(29 78 216);
  }

  .dark .primary-soft-btn {
    border-color: rgba(114, 151, 247, 0.62);
    background: rgba(36, 47, 67, 0.86);
    color: rgb(191 219 254);
  }

  .dark .primary-soft-btn:hover {
    border-color: rgba(138, 174, 255, 0.82);
    color: rgb(219 234 254);
  }

  .dark .glass-card {
    background: rgba(20, 27, 42, 0.92);
    border-color: rgba(124, 164, 255, 0.42);
    -webkit-backdrop-filter: blur(22px) saturate(170%);
    backdrop-filter: blur(22px) saturate(170%);
    box-shadow:
      inset 0 1px 0 rgba(197, 219, 255, 0.16),
      0 18px 32px -20px rgba(4, 10, 24, 0.76),
      0 30px 56px -30px rgba(6, 10, 20, 0.9);
  }

  .dark .glass-card::before {
    background:
      linear-gradient(140deg, rgba(137, 171, 255, 0.14) 0%, rgba(66, 87, 142, 0.08) 48%, rgba(112, 86, 246, 0.2) 100%);
  }

  .flip-face {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    will-change: transform;
  }

  .flip-face.glass-card {
    background: rgba(255, 255, 255, 0.68);
    -webkit-backdrop-filter: blur(16px) saturate(130%);
    backdrop-filter: blur(16px) saturate(130%);
  }

  .dark .flip-face.glass-card {
    background: rgba(20, 27, 42, 0.82);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    backdrop-filter: blur(18px) saturate(160%);
  }

  .card-tilt {
    --px: 50%;
    --py: 50%;
  }

  .card-tilt::after {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    background:
      radial-gradient(circle at var(--px) var(--py), rgba(255, 255, 255, 0.36), rgba(255, 255, 255, 0) 42%);
    opacity: 0.6;
    transition: opacity 220ms ease;
  }

  .dark .card-tilt::after {
    background:
      radial-gradient(circle at var(--px) var(--py), rgba(146, 184, 255, 0.2), rgba(146, 184, 255, 0) 46%);
    opacity: 0.72;
  }

  .card-tilt > * {
    position: relative;
    z-index: 1;
  }

  .telegram-auth-inline {
    @apply flex h-10 items-center;
    line-height: 1;
  }

  .telegram-auth-widget-slot {
    @apply flex items-center justify-center;
    line-height: 0;
  }

  .telegram-auth-widget-slot iframe {
    display: block !important;
    margin: 0 !important;
    vertical-align: middle !important;
  }

  .card-depth {
    transition: box-shadow 220ms ease;
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.7),
      0 14px 24px -16px rgba(56, 70, 102, 0.28),
      0 28px 42px -30px rgba(84, 99, 132, 0.3);
  }

  .card-depth:hover {
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.78),
      0 18px 30px -16px rgba(56, 70, 102, 0.36),
      0 32px 52px -26px rgba(84, 99, 132, 0.36);
  }

  .dark .card-depth {
    box-shadow:
      inset 0 1px 0 rgba(173, 200, 255, 0.2),
      0 18px 30px -16px rgba(2, 8, 23, 0.7),
      0 34px 58px -28px rgba(2, 8, 23, 0.62);
  }

  .dark .card-depth:hover {
    box-shadow:
      inset 0 1px 0 rgba(191, 214, 255, 0.28),
      0 24px 36px -16px rgba(2, 8, 23, 0.78),
      0 40px 68px -26px rgba(2, 8, 23, 0.68);
  }

  .difficulty-badge {
    @apply inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-semibold uppercase tracking-[0.08em];
    animation: gentlePulse 2.4s ease-in-out infinite;
  }

  .difficulty-easy {
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.75),
      0 0 0 1px rgba(91, 149, 255, 0.24),
      0 12px 24px -24px rgba(86, 147, 255, 0.34);
  }

  .difficulty-medium {
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.78),
      0 0 0 1px rgba(141, 117, 255, 0.3),
      0 12px 24px -24px rgba(130, 103, 255, 0.32);
  }

  .difficulty-hard {
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.8),
      0 0 0 1px rgba(108, 77, 255, 0.36),
      0 14px 28px -24px rgba(100, 76, 222, 0.36);
  }

  .difficulty-hard::after {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    border: 1px solid transparent;
    background:
      linear-gradient(115deg, rgba(85, 149, 255, 0.12), rgba(128, 90, 255, 0.28), rgba(85, 149, 255, 0.12)) border-box;
    -webkit-mask:
      linear-gradient(#fff 0 0) padding-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    animation: hardBorderSweep 6.4s linear infinite;
  }

  .difficulty-badge[data-difficulty='easy'] {
    background: rgba(92, 156, 255, 0.16);
    color: rgb(41 94 187);
    border: 1px solid rgba(84, 139, 245, 0.38);
  }

  .difficulty-badge[data-difficulty='medium'] {
    background: rgba(137, 106, 255, 0.14);
    color: rgb(97 59 197);
    border: 1px solid rgba(125, 88, 248, 0.4);
  }

  .difficulty-badge[data-difficulty='hard'] {
    background: rgba(86, 66, 201, 0.16);
    color: rgb(66 45 173);
    border: 1px solid rgba(91, 67, 208, 0.46);
  }

  .dark .difficulty-easy {
    box-shadow:
      inset 0 1px 0 rgba(186, 211, 255, 0.22),
      0 0 0 1px rgba(92, 156, 255, 0.52),
      0 24px 40px -28px rgba(82, 140, 255, 0.56);
  }

  .dark .difficulty-medium {
    box-shadow:
      inset 0 1px 0 rgba(196, 177, 255, 0.24),
      0 0 0 1px rgba(138, 106, 255, 0.6),
      0 24px 40px -28px rgba(131, 98, 255, 0.62);
  }

  .dark .difficulty-hard {
    box-shadow:
      inset 0 1px 0 rgba(197, 181, 255, 0.28),
      0 0 0 1px rgba(106, 73, 255, 0.68),
      0 26px 42px -26px rgba(97, 70, 219, 0.72);
  }

  .dark .difficulty-badge[data-difficulty='easy'] {
    background: rgba(91, 155, 255, 0.2);
    border-color: rgba(89, 152, 255, 0.52);
    color: rgb(178 211 255);
  }

  .dark .difficulty-badge[data-difficulty='medium'] {
    background: rgba(138, 106, 255, 0.2);
    border-color: rgba(138, 106, 255, 0.56);
    color: rgb(220 209 255);
  }

  .dark .difficulty-badge[data-difficulty='hard'] {
    background: rgba(106, 73, 255, 0.22);
    border-color: rgba(106, 73, 255, 0.62);
    color: rgb(222 213 255);
  }

  .mastered-card {
    background: rgba(243, 250, 255, 0.58);
    border-color: rgba(136, 180, 255, 0.48);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.88),
      0 0 0 1px rgba(125, 172, 255, 0.36),
      0 14px 28px -20px rgba(120, 170, 255, 0.32);
  }

  .dark .mastered-card {
    background: rgba(19, 35, 62, 0.72);
    border-color: rgba(117, 165, 255, 0.52);
    box-shadow:
      inset 0 1px 0 rgba(195, 219, 255, 0.2),
      0 0 0 1px rgba(104, 159, 255, 0.42),
      0 16px 30px -20px rgba(60, 116, 255, 0.44);
  }

  .mastered-check {
    @apply grid h-5 w-5 place-items-center rounded-full text-[11px] font-black;
    background: linear-gradient(145deg, rgba(83, 151, 255, 0.3), rgba(116, 193, 255, 0.36));
    color: rgb(29 95 198);
    border: 1px solid rgba(76, 142, 245, 0.5);
  }

  .dark .mastered-check {
    color: rgb(197 221 255);
    border-color: rgba(92, 157, 255, 0.54);
    background: linear-gradient(145deg, rgba(67, 123, 255, 0.34), rgba(86, 171, 255, 0.44));
  }

  .mastered-sweep {
    animation: masteredSweep 0.9s ease-out 1;
  }

  .tag-chip {
    @apply rounded-full border px-2.5 py-0.5 text-[11px] font-medium transition;
    transform-origin: center;
    opacity: 0.88;
    filter: saturate(0.92);
    transition:
      transform 170ms ease,
      opacity 170ms ease,
      filter 170ms ease,
      box-shadow 190ms ease,
      border-color 190ms ease;
  }

  .tag-chip:not(.tag-selected):hover {
    transform: scale(1.04);
    opacity: 1;
    filter: saturate(1.02);
  }

  .tag-cat-rendering {
    background: rgba(90, 157, 255, 0.14);
    border-color: rgba(96, 164, 255, 0.44);
    color: rgb(36 96 186);
    box-shadow: 0 10px 22px -16px rgba(84, 151, 255, 0.44);
  }

  .tag-cat-physics {
    background: rgba(112, 224, 194, 0.18);
    border-color: rgba(95, 212, 182, 0.46);
    color: rgb(19 124 106);
    box-shadow: 0 10px 22px -16px rgba(84, 199, 169, 0.44);
  }

  .tag-cat-csharp {
    background: rgba(191, 174, 255, 0.2);
    border-color: rgba(175, 152, 255, 0.46);
    color: rgb(92 68 205);
    box-shadow: 0 10px 22px -16px rgba(157, 128, 255, 0.44);
  }

  .tag-cat-architecture {
    background: rgba(134, 147, 255, 0.16);
    border-color: rgba(120, 134, 255, 0.46);
    color: rgb(67 79 194);
    box-shadow: 0 10px 22px -16px rgba(109, 122, 240, 0.46);
  }

  .tag-cat-networking {
    background: rgba(135, 153, 255, 0.17);
    border-color: rgba(126, 143, 255, 0.48);
    color: rgb(74 88 206);
    box-shadow: 0 10px 22px -16px rgba(108, 125, 245, 0.48);
  }

  .tag-cat-ecs {
    background: rgba(156, 120, 255, 0.12);
    border-color: rgba(151, 112, 255, 0.44);
    color: rgb(98 55 206);
    box-shadow: 0 8px 20px -16px rgba(128, 88, 242, 0.5);
  }

  .tag-cat-default {
    background: rgba(108, 129, 167, 0.1);
    border-color: rgba(105, 124, 161, 0.3);
    color: rgb(76 93 130);
    box-shadow: 0 8px 20px -18px rgba(108, 127, 163, 0.36);
  }

  .tag-chip:not(.tag-selected):hover {
    box-shadow:
      0 12px 24px -14px rgba(95, 127, 193, 0.4),
      0 0 0 1px rgba(116, 151, 226, 0.3);
  }

  .tag-selected {
    transform: scale(1.06);
    opacity: 1;
    filter: saturate(1.08);
    box-shadow:
      0 0 0 1px rgba(63, 121, 240, 0.68),
      0 14px 28px -12px rgba(79, 143, 255, 0.72);
  }

  .tag-selected:hover {
    transform: scale(1.06);
    box-shadow:
      0 0 0 1px rgba(63, 121, 240, 0.72),
      0 16px 30px -12px rgba(79, 143, 255, 0.78);
  }

  .dark .tag-cat-rendering {
    background: rgba(101, 151, 255, 0.24);
    border-color: rgba(110, 162, 255, 0.62);
    color: rgb(210 228 255);
    box-shadow: 0 10px 24px -16px rgba(96, 148, 255, 0.6);
  }

  .dark .tag-cat-physics {
    background: rgba(82, 195, 164, 0.24);
    border-color: rgba(88, 207, 176, 0.62);
    color: rgb(193 255 236);
    box-shadow: 0 10px 24px -16px rgba(82, 195, 164, 0.58);
  }

  .dark .tag-cat-csharp {
    background: rgba(155, 128, 255, 0.24);
    border-color: rgba(162, 135, 255, 0.62);
    color: rgb(231 221 255);
    box-shadow: 0 10px 24px -16px rgba(145, 120, 255, 0.6);
  }

  .dark .tag-cat-architecture {
    background: rgba(116, 136, 255, 0.24);
    border-color: rgba(124, 145, 255, 0.62);
    color: rgb(214 223 255);
    box-shadow: 0 10px 24px -16px rgba(112, 131, 252, 0.58);
  }

  .dark .tag-cat-networking {
    background: rgba(128, 125, 255, 0.24);
    border-color: rgba(136, 132, 255, 0.62);
    color: rgb(216 215 255);
    box-shadow: 0 10px 24px -16px rgba(123, 119, 255, 0.58);
  }

  .dark .tag-cat-ecs {
    background: rgba(148, 112, 255, 0.22);
    border-color: rgba(152, 116, 255, 0.58);
    color: rgb(231 218 255);
    box-shadow: 0 10px 24px -16px rgba(136, 98, 255, 0.56);
  }

  .dark .tag-cat-default {
    background: rgba(109, 129, 170, 0.2);
    border-color: rgba(112, 138, 189, 0.46);
    color: rgb(193 210 245);
    box-shadow: 0 10px 24px -18px rgba(108, 127, 163, 0.52);
  }

  .dark .tag-selected {
    background: rgba(190, 24, 93, 0.24);
    border-color: rgba(251, 113, 133, 0.86);
    color: rgb(255 228 234);
    box-shadow:
      0 0 0 1px rgba(251, 113, 133, 0.88),
      0 18px 32px -12px rgba(225, 29, 72, 0.72);
  }

  .dark .tag-selected:hover {
    background: rgba(190, 24, 93, 0.3);
    border-color: rgba(251, 113, 133, 0.95);
    box-shadow:
      0 0 0 1px rgba(251, 113, 133, 0.96),
      0 20px 36px -12px rgba(244, 63, 94, 0.8);
  }

  .cta-button {
    @apply relative overflow-hidden rounded-xl font-semibold text-white transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-brand-400 dark:focus-visible:ring-offset-slate-900;
    background: linear-gradient(112deg, #2f7bff 0%, #6c5cff 50%, #2f7bff 100%);
    background-size: 160% 160%;
    box-shadow:
      0 10px 24px -14px rgba(62, 114, 255, 0.54),
      inset 0 1px 0 rgba(255, 255, 255, 0.28);
  }

  .cta-button:hover {
    transform: scale(1.03);
    box-shadow:
      0 16px 30px -14px rgba(74, 121, 255, 0.58),
      0 0 0 1px rgba(149, 182, 255, 0.34),
      0 0 24px rgba(90, 140, 255, 0.22),
      inset 0 1px 0 rgba(255, 255, 255, 0.38);
  }

  .cta-button::before {
    content: '';
    position: absolute;
    inset: 1px;
    border-radius: inherit;
    border: 1px solid rgba(255, 255, 255, 0.32);
    pointer-events: none;
  }

  .cta-button:active {
    transform: scale(0.99);
    box-shadow:
      0 7px 16px -10px rgba(62, 114, 255, 0.58),
      inset 0 2px 8px rgba(7, 24, 63, 0.32);
  }

  .cta-button:disabled {
    transform: none;
    opacity: 0.62;
    box-shadow:
      0 8px 18px -14px rgba(89, 115, 176, 0.38),
      inset 0 1px 0 rgba(255, 255, 255, 0.24);
  }

  .reaction-bounce {
    animation: reactionBounce 260ms cubic-bezier(0.18, 0.9, 0.22, 1.15);
  }

  .sources-doc {
    @apply rounded-xl border px-3 py-2;
    border-color: rgba(145, 161, 191, 0.36);
    background: rgba(249, 252, 255, 0.66);
  }

  .dark .sources-doc {
    border-color: rgba(111, 132, 179, 0.44);
    background: rgba(25, 34, 53, 0.66);
  }

  .focus-shell {
    @apply relative overflow-hidden rounded-2xl border p-5;
    border-color: rgba(160, 177, 215, 0.46);
    background: rgba(247, 250, 255, 0.72);
    -webkit-backdrop-filter: blur(8px) saturate(120%);
    backdrop-filter: blur(8px) saturate(120%);
  }

  .focus-shell::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
      radial-gradient(circle at 50% 12%, rgba(120, 159, 255, 0.24), rgba(120, 159, 255, 0) 46%);
    z-index: 0;
  }

  .focus-shell > * {
    position: relative;
    z-index: 1;
  }

  .dark .focus-shell {
    border-color: rgba(110, 133, 190, 0.5);
    background: rgba(22, 30, 48, 0.76);
  }

  .dark .focus-shell::before {
    background:
      radial-gradient(circle at 50% 12%, rgba(92, 146, 255, 0.32), rgba(92, 146, 255, 0) 48%);
  }

  .study-card-enter {
    animation: studyCardEnter 300ms cubic-bezier(0.22, 0.75, 0.2, 1);
  }

  .history-card {
    border: 1px solid rgba(152, 171, 211, 0.42);
    background: linear-gradient(180deg, rgba(246, 250, 255, 0.84), rgba(240, 247, 255, 0.76));
    box-shadow:
      0 10px 22px -16px rgba(89, 118, 176, 0.34),
      inset 0 1px 0 rgba(255, 255, 255, 0.68);
    opacity: 0.88;
  }

  .history-badge {
    @apply inline-flex items-center rounded-full px-2 py-1 text-[10px] font-semibold uppercase tracking-[0.14em];
    border: 1px solid rgba(126, 153, 205, 0.46);
    color: rgba(56, 86, 148, 0.9);
    background: rgba(227, 238, 255, 0.8);
  }

  .dark .history-card {
    border-color: rgba(102, 124, 172, 0.52);
    background: linear-gradient(180deg, rgba(24, 33, 52, 0.84), rgba(20, 29, 46, 0.8));
    box-shadow:
      0 12px 24px -16px rgba(46, 68, 112, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.08);
    opacity: 0.9;
  }

  .dark .history-badge {
    border-color: rgba(116, 146, 214, 0.42);
    color: rgba(173, 196, 255, 0.92);
    background: rgba(44, 64, 106, 0.52);
  }

  .history-card-enter {
    animation: historyCardEnter 260ms cubic-bezier(0.22, 0.75, 0.2, 1);
  }

}

@layer utilities {
  .bg-mesh {
    background:
      radial-gradient(circle at 12% 18%, rgba(158, 186, 255, 0.22), transparent 30%),
      radial-gradient(circle at 84% 10%, rgba(208, 193, 255, 0.2), transparent 28%),
      radial-gradient(circle at 72% 86%, rgba(170, 228, 255, 0.16), transparent 26%);
    animation: meshDrift 28s ease-in-out infinite alternate;
  }

  .dark .bg-mesh {
    background:
      radial-gradient(circle at 12% 18%, rgba(88, 132, 226, 0.24), transparent 34%),
      radial-gradient(circle at 84% 10%, rgba(120, 96, 211, 0.2), transparent 30%),
      radial-gradient(circle at 72% 86%, rgba(67, 139, 205, 0.18), transparent 28%);
  }

  .bg-particles {
    background-image:
      radial-gradient(circle at 10% 20%, rgba(120, 149, 210, 0.22) 0 1px, transparent 1px),
      radial-gradient(circle at 30% 78%, rgba(140, 162, 221, 0.18) 0 1px, transparent 1px),
      radial-gradient(circle at 62% 32%, rgba(134, 151, 201, 0.18) 0 1px, transparent 1px),
      radial-gradient(circle at 84% 60%, rgba(153, 171, 220, 0.2) 0 1px, transparent 1px);
    background-size: 180px 180px;
    opacity: 0.55;
    animation: particlesFloat 34s linear infinite;
  }

  .dark .bg-particles {
    opacity: 0.62;
    background-image:
      radial-gradient(circle at 10% 20%, rgba(94, 129, 212, 0.28) 0 1px, transparent 1px),
      radial-gradient(circle at 30% 78%, rgba(114, 140, 204, 0.24) 0 1px, transparent 1px),
      radial-gradient(circle at 62% 32%, rgba(109, 125, 178, 0.24) 0 1px, transparent 1px),
      radial-gradient(circle at 84% 60%, rgba(122, 136, 186, 0.26) 0 1px, transparent 1px);
  }

  .bg-grid {
    background-image:
      linear-gradient(to right, rgba(148, 163, 184, 0.14) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(148, 163, 184, 0.14) 1px, transparent 1px);
    background-size: 42px 42px;
  }

  .dark .bg-grid {
    background-image:
      linear-gradient(to right, rgba(71, 85, 105, 0.25) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(71, 85, 105, 0.25) 1px, transparent 1px);
  }
}

@keyframes meshDrift {
  0% {
    transform: translate3d(0, 0, 0) scale(1);
  }
  100% {
    transform: translate3d(-1.5%, 1.2%, 0) scale(1.04);
  }
}

@keyframes particlesFloat {
  0% {
    transform: translateY(0);
  }
  100% {
    transform: translateY(-24px);
  }
}

@keyframes hardBorderSweep {
  0% {
    filter: hue-rotate(0deg);
  }
  100% {
    filter: hue-rotate(360deg);
  }
}

@keyframes gentlePulse {
  0%,
  100% {
    transform: scale(1);
    opacity: 0.95;
  }
  50% {
    transform: scale(1.04);
    opacity: 1;
  }
}

@keyframes answerReveal {
  0% {
    opacity: 0;
    transform: translateY(8px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes reactionBounce {
  0% {
    transform: scale(1);
  }
  45% {
    transform: scale(1.14);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes masteredSweep {
  0% {
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.85),
      0 0 0 1px rgba(125, 172, 255, 0.2),
      0 0 0 rgba(125, 172, 255, 0);
  }
  70% {
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.95),
      0 0 0 1px rgba(125, 172, 255, 0.52),
      0 0 26px rgba(125, 172, 255, 0.32);
  }
  100% {
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.85),
      0 0 0 1px rgba(125, 172, 255, 0.36),
      0 14px 28px -20px rgba(120, 170, 255, 0.32);
  }
}

@keyframes studyCardEnter {
  0% {
    opacity: 0;
    transform: translateY(18px) scale(0.985);
    filter: saturate(0.92);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
    filter: saturate(1);
  }
}

@keyframes historyCardEnter {
  0% {
    opacity: 0;
    transform: translateY(-14px) scale(0.992);
  }
  100% {
    opacity: 0.9;
    transform: translateY(0) scale(1);
  }
}
